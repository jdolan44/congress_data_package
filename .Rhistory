group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(numberTerms%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age)*5, y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(numberTerms=numberTerms%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(x="Age group", y="Average number of bills sponsored")
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(x="Age Group", y="Average # of Bills Sponsored")
congress_data %>%
filter(passPrcnt>0 & !is.na(passPrcnt)) %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=passPrcnt, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
congress_data %>%
filter(passPrcnt>0 ) %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=passPrcnt, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
congress_data %>%
filter(passPrcnt>0 & !is.na(gender)) %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=passPrcnt, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
congress_data %>%
filter(passPrcnt>0) %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=passPrcnt, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
congress_data %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=numSpon, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2)
congress_data %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=numSpon, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
congress_data %>%
ggplot(aes(x=congNum, fill=party)) +
geom_bar() +
scale_fill_manual(values=c("#5156e0", "#00aa00", "#e05151")) +
labs(
title="Party Distribution of Congress",
x="Congress Number",
y="Number of Seats",
fill="Party"
)
congress_data %>%
ggplot(aes(x=congNum, fill=gender)) +
geom_bar(color="black") +
scale_fill_manual(values=c("#e05151", "#5156e0")) +
labs(
title="Gender Distribution of Congress",
x="Congress Number",
y="Number of Seats",
fill="Gender"
)
#| echo: false
#| warning: false
num_black <- congress_data %>%
filter(black==1) %>%
ggplot(aes(x=congNum, fill=party)) +
geom_bar(color="black") +
scale_fill_manual(values=c("#5156e0", "#00aa00", "#e05151")) +
labs(x="Congress Number", y="Black Representatives") +
theme(axis.title.x = element_blank())
num_hispanic <- congress_data %>%
filter(hispanic == 1) %>%
ggplot(aes(x=congNum, fill=party)) +
geom_bar(color="black") +
theme(legend.position = "none") +
scale_fill_manual(values=c("#5156e0", "#e05151")) +
labs(x="Congress Number", y="Hispanic Representatives")
num_black / num_hispanic
congress_data %>%
ggplot(aes(x=congNum, y=age)) +
geom_point(color="lightblue", alpha=0.5) +
geom_smooth(color="#512d6d",fill="darkgreen") +
labs(x="Congress Number",y="Age")
#| echo: false
#| warning: false
congress_data %>%
ggplot(aes(x=congNum, y=age)) +
geom_point(color="lightblue", alpha=0.5) +
geom_smooth(color="#512d6d",fill="darkgreen") +
labs(x="Congress Number",y="Age")
congress_data %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(numberTerms=numberTerms) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(numberTerms=numberTerms) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
filter(!is.na(passPrcnt))
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passpr)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passpr)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(age=age%/%5) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*5), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(age=age%/%5) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(age*5), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
#| echo: false
#| warning: false
congress_data %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E")
#| echo: false
#| warning: false
congress_data %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(
x="Number of Terms Served",
y="Number of Bills Sponsored"
)
#| echo: false
#| warning: false
congress_data %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(
x="Number of Terms Served",
y="Average Number of Bills Sponsored"
)
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E")
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(numberTerms=numberTerms%/%3) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(numberTerms*3), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(
x="Number of Terms Served",
y="Pass Percentage"
)
congress_data %>%
group_by(age=age%/%5) %>%
summarise(mean_numSpon = mean(numSpon)) %>%
ggplot(aes(x=factor(age*5), y=mean_numSpon)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(x="Age Group", y="Average # of Bills Sponsored")
congress_data %>%
filter(!is.na(passPrcnt)) %>%
group_by(age=age%/%5) %>%
summarise(mean_passprcnt = mean(passPrcnt)) %>%
ggplot(aes(x=factor(age*5), y=mean_passprcnt)) +
geom_bar(stat='identity', fill="#553E4E") +
labs(
x="Age Group",
y="Pass Percentage"
)
congress_data %>%
filter(passPrcnt>0) %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=passPrcnt, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
congress_data %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=numSpon, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50)
#| echo: false
#| warning: false
congress_data %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=numSpon, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50) +
labs(x="", y="# of Bills Sponsored")
#| echo: false
#| warning: false
congress_data %>%
group_by(gender) %>%
ggplot(aes(x=gender, y=numSpon, color=gender)) +
scale_color_manual(values=c("#e05151", "#5156e0")) +
geom_boxplot(outlier.shape = NA, color="black") +
geom_jitter(width=0.35, alpha=0.2) +
ylim(0, 50) +
labs(x="", y="# of Bills Sponsored", color="Gender")
?initial_split
library(tidyverse)
library(tidymodels)
?initial_split
View(congress_data)
library(tidyverse)
library(tidymodels)
#get testing data
set.seed(123)
congress_data_split <-
initial_split(congress_data, prop = 0.8, strata = NULL)
congress_data_train <- training(congress_data_split)
congress_data_test <- testing(congress_data_split)
#get specification
gam_spec <-
gen_additive_mod() %>%
set_mode("regression")
#get fit
gam_fit <- gam_spec %>%
fit(numSpon ~ s(numberTerms, k=10),data=tourney_train)
#get fit
gam_fit <- gam_spec %>%
fit(numSpon ~ s(numberTerms, k=10),data=congress_data_train)
#predict using the model
congress_data_preds <- gam_fit %>%
predict(congress_data_test) %>%
cbind(congress_data_test)
#glimpse the prediction cols
glimpse(congress_data_preds)
#find the RMSE
congress_data_preds %>%
rmse(truth = tourney_w, estimate = .pred)
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
source("~/GitHub/congress_data_package/models.R")
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
View(congress_data_preds)
#compare predictions to actual
congress_data_preds %>%
select(numSpon, .pred)
congress_data_split <-
initial_split(congress_data, prop = 0.8, strata = party)
source("~/GitHub/congress_data_package/models.R")
#compare predictions to actual
congress_data_preds %>%
select(numSpon, .pred)
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
#get fit
gam_fit <- gam_spec %>%
fit(numSpon ~ s(numberTerms, age, k=10),data=congress_data_train)
#predict using the model
congress_data_preds <- gam_fit %>%
predict(congress_data_test) %>%
cbind(congress_data_test)
#glimpse the prediction cols
glimpse(congress_data_preds)
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
congress_data_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
View(gam_fit)
rm(gam_fit)
#get fit for # of bills sponsored
numspon_fit <- gam_spec %>%
fit(numSpon ~ s(numberTerms, age, k=10),data=congress_data_train)
rm(congress_data_preds)
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
passprcnt_preds %>%
rmse(truth = passPrcnt, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(passPrcnt, .pred)
?sapply
congress_data() %>%
select(age, gender)
library(tidyverse)
library(tidymodels)
congress_data() %>%
select(age, gender)
congress_data %>%
select(age, gender)
congress_data %>%
select(party, gender)
congress_data %>%
select(party, gender) %>%
unclass()
congress_data %>%
select(gender) %>%
unclass()
congress_data %>%
select(gender) %>%
factor() %>%
unclass()
congress_data %>%
select(gender) %>%
factor() %>%
unclass()
congress_data%>% select(party)
source("~/GitHub/congress_data_package/models.R")
source("~/GitHub/congress_data_package/models.R")
source("~/GitHub/congress_data_package/models.R")
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
source("~/GitHub/congress_data_package/models.R")
#get fit for pass percent
passprcnt_fit <- gam_spec %>%
fit(passPrcnt ~ s(numberTerms, age, gender_binary, party_binary, k=3),data=congress_data_train)
#get fit for pass percent
passprcnt_fit <- gam_spec %>%
fit(passPrcnt ~ s(numberTerms, age, gender_binary, party_binary, k=20),data=congress_data_train)
#get fit for # of bills sponsored
numspon_fit <- gam_spec %>%
fit(numSpon ~ s(numberTerms, age, gender_binary, party_binary, k=20),data=congress_data_train)
#predict using the model
numspon_preds <- numspon_fit %>%
predict(congress_data_test) %>%
cbind(congress_data_test)
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#get fit for pass percent
passprcnt_fit <- gam_spec %>%
fit(passPrcnt ~ s(numberTerms, age, gender_binary, party_binary, k=20),data=congress_data_train)
#predict using the model
passprcnt_preds <- passprcnt_fit %>%
predict(congress_data_test) %>%
cbind(congress_data_test)
#glimpse the prediction cols
glimpse(passprcnt_preds)
#find the RMSE
passprcnt_preds %>%
rmse(truth = passPrcnt, estimate = .pred)
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(numSpon, .pred)
#find the RMSE
passprcnt_preds %>%
rmse(truth = passPrcnt, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(passPrcnt, .pred)
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(numSpon, .pred)
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(numSpon, .pred) %>%
glimpse()
#| echo: false
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(numSpon, .pred) %>%
glimpse()
```
#| echo: false
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(numSpon, .pred) %>%
glimpse()
```
#| echo: false
#find the RMSE
numspon_preds %>%
rmse(truth = numSpon, estimate = .pred)
#compare predictions to actual
numspon_preds %>%
select(numSpon, .pred) %>%
glimpse()
```
#| echo: false
#find the RMSE
passprcnt_preds %>%
rmse(truth = passPrcnt, estimate = .pred)
#compare predictions to actual
passprcnt_preds %>%
select(passPrcnt, .pred) %>%
glimpse()
